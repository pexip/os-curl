From: Markus Koschany <apo@debian.org>
Date: Sat, 23 Jul 2022 18:57:52 +0200
Subject: CVE-2021-22945

Origin: https://github.com/curl/curl/commit/43157490a5054bd24256fe12876931e8abc9df49
---
 lib/mqtt.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/lib/mqtt.c b/lib/mqtt.c
index e324ec3..edcd6d7 100644
--- a/lib/mqtt.c
+++ b/lib/mqtt.c
@@ -124,6 +124,10 @@ static CURLcode mqtt_send(struct connectdata *conn,
     mq->sendleftovers = sendleftovers;
     mq->nsend = nsend;
   }
+  else {
+    mq->sendleftovers = NULL;
+    mq->nsend = 0;
+  }
   return result;
 }
 
