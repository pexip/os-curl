From 3c3622b66221d89509cffaa693fc7dcd5c5b96cf Mon Sep 17 00:00:00 2001
From: Daniel Stenberg <daniel@haxx.se>
Date: Wed, 2 Oct 2013 15:31:10 +0200
Subject: [PATCH] OpenSSL: acknowledge CURLOPT_SSL_VERIFYHOST without
 VERIFYPEER

Setting only CURLOPT_SSL_VERIFYHOST without CURLOPT_SSL_VERIFYPEER set
should still verify that the host name fields in the server certificate
is fine or return failure.

Bug: http://curl.haxx.se/mail/lib-2013-10/0002.html
Reported-by: Ishan SinghLevett
---
 lib/ssluse.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: curl-7.22.0/lib/ssluse.c
===================================================================
--- curl-7.22.0.orig/lib/ssluse.c	2013-11-29 08:33:43.893151388 -0500
+++ curl-7.22.0/lib/ssluse.c	2013-11-29 08:33:43.885151388 -0500
@@ -2410,7 +2410,7 @@
    * operations.
    */
 
-  if(!data->set.ssl.verifypeer)
+  if(!data->set.ssl.verifypeer && !data->set.ssl.verifyhost)
     (void)servercert(conn, connssl, FALSE);
   else
     retcode = servercert(conn, connssl, TRUE);
