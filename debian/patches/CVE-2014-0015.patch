Description: fix information disclosure via incorrect NTLM credential reuse
Origin: upstream, curl.haxx.se/CVE-2014-0015-7-27.patch

Index: curl-7.22.0/lib/url.c
===================================================================
--- curl-7.22.0.orig/lib/url.c	2014-01-31 08:35:08.499398742 -0500
+++ curl-7.22.0/lib/url.c	2014-01-31 08:35:08.495398742 -0500
@@ -2994,8 +2994,8 @@
         }
         if((needle->handler->protocol & CURLPROTO_FTP) ||
            ((needle->handler->protocol & CURLPROTO_HTTP) &&
-            ((data->state.authhost.want==CURLAUTH_NTLM) ||
-             (data->state.authhost.want==CURLAUTH_NTLM_WB)))) {
+            ((data->state.authhost.want & CURLAUTH_NTLM) ||
+             (data->state.authhost.want & CURLAUTH_NTLM_WB)))) {
           /* This is FTP or HTTP+NTLM, verify that we're using the same name
              and password as well */
           if(!strequal(needle->user, check->user) ||
