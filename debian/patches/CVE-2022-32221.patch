From: Samuel Henrique <samueloph@debian.org>
Date: Tue, 27 Dec 2022 00:05:50 +0000
Subject: setopt: when POST is set, reset the 'upload' field (CVE-2022-32221)

Origin: https://github.com/curl/curl/commit/a64e3e59938abd7d667e4470a18072a24d7e9de9
---
 lib/setopt.c | 1 +
 1 file changed, 1 insertion(+)

Index: curl/lib/setopt.c
===================================================================
--- curl.orig/lib/setopt.c
+++ curl/lib/setopt.c
@@ -626,6 +626,7 @@ CURLcode Curl_vsetopt(struct Curl_easy *
     }
     else
       data->set.method = HTTPREQ_GET;
+    data->set.upload = FALSE;
     break;
 
   case CURLOPT_HTTPPOST:
